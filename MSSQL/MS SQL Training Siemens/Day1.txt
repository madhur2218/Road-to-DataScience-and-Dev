select * from emp;
select * from dept;
-- projection
SELECT empno,ENAME,sal from EMP;
-- column alias name
select empno,ename as empname, sal "Emp Salary",sal*12 as annual_salary from emp;
-- Arithmetic operator ,+,-,*,/
select (10-5)*3/2 --BODMAS, relations,logical
-- get the  Total Annual salary (monthly sal+monthy bonus ) multipled by 12
select empno,ename,sal, 100 as bonus, ( sal+100)*12 as total_annualsal from emp;
-- SELECTION-- filtering data -- criteria/condition -- where clause
--  list emp who earn sal>2000
select * from emp where sal>2000;
-- relational/comparision operator-- =,>,<,>=,<=,!=,<>,In,BETWEEN, like, is null
-- list emp from dept 30
select * from emp where deptno=30;
-- list all salesman
select * from emp where job='salesman';
-- list all emp who joined in the year 1982
select * from emp where hiredate between '1982-01-01' and '1982-12-31'
-- list all emp except clerk
select * from emp where job!='clerk';
select * from emp where job <>'clerk';
select * from emp where sal between 2000 and 3000;
select * from emp where ename between 'a' and 'g';
-- list all salesman and analyst
select * from emp where job in('salesman' ,'analyst','x','g');
-- like -- similar to = (wild card pattern matching character % can number any char, _ any single char)
-- list all emp who joined in 1982
select * from emp where hiredate like '1982%';
select * from emp where hiredate like '1982______';
select * from emp where ename like 's%';
select * from emp where ename like '%s';
select * from emp where job like '%MAN%';
select * from emp where ename like '_a%';
-- list all emp who joined in the month of december
select * from emp where hiredate like '%-12-%'
select * from emp where comm is null;
select * from emp where comm is not null;
-- query with multiple criterias -- logical operators (AND, OR, NOT)
-- list all clerks who earn sal>1000
select * from emp where job='clerk' and sal>1000;
-- list all salesman who either earn sal>1500 or belong to dept 30
select * from emp where job='salesman' and (sal>1500 or deptno=30);
-- list all salesman who earn comm
select * from emp where job='salesman' and comm is not null;
select distinct job from emp;
select distinct comm from emp;
select empno,ename,sal,comm,sal+100 newsal, comm+10 newcomm, sal+comm totalsal from emp;
-----------------------------------------------------------------------------------------------------------
-- fetch N records, sorting data

select * from emp;
select top 5 * from emp;
-- to fetch n records from sorted list (order by)
select * from emp order by sal  desc;
-- list emp with highest salary
select top 1 * from emp order by sal desc;
-- list all emp sorted by name
select * from emp order by ename
-- list all emp sorted by job
select * from emp order by job;
select * from emp order by job,sal desc;
select empno,ename as empname,job,sal from emp order by empname;
select * from emp order by 5 desc;
-- list all salesman based on seniority
select * from emp where job='salesman' order by hiredate;
-- list emp skipping first 2 emp with lowest salary
select * from emp order by sal offset 2 rows;
-- list  5 emp skipping first 2 emp with lowest salary
select * from emp order by sal offset 2 rows fetch next 5 rows only
-- list 3rd to 6th emp emp sorted by sal
select * from emp order by sal offset 2 rows fetch next  4 rows only;




Select * From EMP


------------------BUILT IN FUNCTIONS-----------------

---Scalar functions/single row functions  -> for every input we get one iutput---
select LOWER(ename) From emp
select UPPER('siemens')

Select left('xyz@gmail.com', CHARINDEX('@','xyz@gmail.com' )-1)

--Numeric--
Select ABS(-10)
Select SIGN(-239)
sELECT POWER(3,12)
Select SQRT(45)
Select ROUND (12.3131, 2)
Select FLOOR (1.99783)
Select CEILING (1.002)

--Date--
Select GETDATE()
Select DATEADD(MONTH, 2 , GETDATE())
Select DATEDIFF(MONTH,HIREDATE,GETDATE()) From EMP;
Select datename(DAYOFYEAR, GETDATE())
Select datename(WEEKDAY,GETDATE()), DATENAME(quarter,GETDATE())
Select DATEPART(week, GETDATE()), DATEPART(WEEKDAY,GETDATE())
Select datepart(year, GETDATE()),DATEPART(month, GETDATE())

---Caste and Conversion---
Select CAST (12.23 AS INT)
Select CAST (123.132 AS varchar)
Select Convert(int, 12.32)
Select Convert(varchar, GETDATE(), 100)    100 till 114 format patterns for dates
Select Convert(varchar, GETDATE(), 101)
SELECT CAST(14.85 AS int);
SELECT CAST(14.85 AS float);
SELECT CAST('2014-05-02' AS datetime);
-- convert(datatype size, exp,format)
SELECT CONVERT(int, 14.85);
SELECT CONVERT(float, 14);
SELECT CONVERT(float, '15.6');
SELECT CONVERT(datetime, '2014-05-02');
SELECT CONVERT(varchar, getdate(), 103);
SELECT CONVERT(varchar, getdate(), 104), CONVERT(varchar, getdate(), 107), CONVERT(varchar, getdate(), 108);
select CONVERT(char(10),getdate(), 112)
select CONVERT(char(40),getdate(), 111)
elect CONVERT(char(25),getdate(), 100)
Select Convert(varchar, GETDATE(), 107)
Select Convert(varchar, GETDATE(), )


---Generic Types---
Select empno,ename,sal,comm, isnull(comm,10) newcomm from emp;
Select empno,ename,sal,comm, isnull(convert (varchar,comm),'N/A') newcomm from Emp;


Select empno,ename,job,sal, 
Case
when sal between 500 and 1000 then 'A Grade'
when sal between 100 and 500 then 'B Grade'
ELSE 'XGRADE' end as empgrade From Emp


Select empno,ename,job,sal, 
Case deptno
 when 10 then 'A'
 WHEN 20 then 'B'
 else 'X' end as empgrade from emp

 Select sum(sal), max(sal), max(hiredate) From emp;
 Select sum(sal) from emp where deptno in (20,30);
 //Total salary paid for employeer who earned comission

 Select count(*), count (mgr),count(Distinct (job)) From emp
 Select count(*) from emp where job='clerk'

 Select count(*) From emp where comm Not Null;


 ---Grouping of data (Group by)---
 Select job, count(*) as hct from emp
 Group By job;


 Select job, count(*) as hct from emp
 Where salary >1000
 Group By job
 Order By job;

 Select deptno, min(sal) misal, max (sal) masal From emp 
 groupby deptno
 order by deptno;


  Select deptno, min(sal) misal, max (sal) masal From emp 
  Where manager is not null
 groupby deptno
 order by deptno;


 
  Select deptno, min(sal) misal, max (sal) masal From emp 
  Where manager is not null
 groupby deptno
 order by deptno
 Having min(sal)>1000

 //Doubt - check for Groupby and having clause order in which these commands execute

 --get deptwise headcount
select deptno, job count(*) from emp group by deptno, job order by deptno;

Select count(*) From emp
Select * From EMP
wHERE manager is not null
Group By  mgr


Select year (Hiredate )count(*) From emp
Group By year(Hiredate)

SELECT e.empno, e.ename, e.sal, e.deptno, d.dname from emp e Join dept d  on e.deptno = d.deptno;

Select * From salgrade


Select * From emp 
JOIN
salgrade s on e.sal	Between s.losal and s.hisal   

---3 table join(emp, dept, salgrade)


--Correlated Subqueries
--Inline Views
--Common table Expression/With queries
--Exists operator


Lostless join

Fulldependency -all columns dependent on primary key
Database - querying and pullying out the reports and data as per our need

Builtin Functions MSSQL Server: 

Stored Porcedures
Treadata to snowflake migration

Scalar functions - completely different for diff sql

Group functions/Aggregate Function

Joins and Subqueries (VV IMP)


















